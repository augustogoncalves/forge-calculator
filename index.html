<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon"
        href="https://github.com/Autodesk-Forge/learn.forge.viewmodels/raw/master/img/favicon.ico">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />
    <title>Forge Price Calculator</title>
</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <script>
        let totalCost = 0;
        $(document).ready(() => {
            $('#MDAdd').click(() => {
                let where = $('#MDSource').val();
                let type = $('#MDFileFormat').val();
                let number = $('#MDCount').val();
                let frequency = $('#MDFrequency').val();
                let unitCost = (where == 'BIM360' ? 0 : 1) * ((new RegExp("RVT|NWC|NWD")).test(type) ? 1.5 : 0.2)
                let totalCost = unitCost * number * frequency;
                let rowId = 'costRow' + Date.now();
                let pdf = (type == 'PDF' ? '<i class="fas fa-info-circle" style="cursor:help" onclick="showHelp(\'PDF\')"></i>' : '');
                $('#MDTable tr:last').after('<tr id=' + rowId + '><td>' + where + '</td><td>' + type + '</td><td>' + number + ' x ' + frequency + ' = ' + number * frequency + '</td><td>' + number * frequency + ' x ' + unitCost + ' = ' + totalCost.toFixed(1) + ' ' + pdf + '</td><td><i class="far fa-trash-alt" onclick="deleteRow(\'' + rowId + '\', ' + totalCost + ')"></i></td></tr>');
                updateTotal(totalCost);
                $('#MDTable').show();
            })

            $('#DAAdd').click(() => {
                let engine = $('#DAEngine').val();
                let size = Number.parseInt($('#DASize').val());
                let complexity = $('#DAComplexity').val();
                let frequency = $('#DAFrequency').val();
                let cost = (engine == 'AutoCAD' ? 4 : 6);
                time = getTime(engine, size, complexity);
                let totalCost = cost * time / 60 / 60 * frequency;
                let rowId = 'costRow' + Date.now();
                $('#DATable tr:last').after('<tr id=' + rowId + '><td>' + engine + '</td><td>' + time + 's * ' + cost + '/hour = ' + (time / 60 / 60 * cost).toFixed(3) + '</td><td>' + frequency + '</td><td>' + totalCost.toFixed(3) + '</td><td><i class="far fa-trash-alt" onclick="deleteRow(\'' + rowId + '\', ' + totalCost + ')"></i></td></tr>');
                updateTotal(totalCost);
                $('#DATable').show();
            })

            /*$("#DAEngine").change(function () {
                let min = DAComplexity[this.value].min;
                let max = DAComplexity[this.value].max;
                let median = DAComplexity[this.value].median;
                $('#DATimeComplexity').attr('min', min);
                $('#DATimeComplexity').attr('max', max);
                $('#DATimeComplexity').val(median);
                $('#ComplexityPreview').html(median);
            }).change();*/

            $('#MDTable').hide();
            $('#DATable').hide();
        })

        // based on usage history
        let DAComplexity = {
            Max: { min: 48, max: 232/*254*/, median: 90 },
            AutoCAD: { min: 3, max: 26/*99*/, median: 9 },
            Inventor: { min: 3, max: 208/*1345*/, median: 17 },
            Revit: [
                {
                    size: { min: 0, max: 10 },
                    min: 3, median: 21, avg: 35, perc95: 82, max: 5416
                },
                {
                    size: { min: 10, max: 20 },
                    min: 14, median: 71, avg: 243, perc95: 835, max: 3985
                },
                {
                    size: { min: 20, max: 30 },
                    min: 14, median: 49, avg: 98, perc95: 289, max: 1274
                }]

        }

        function getTime(engine, size, complexity) {
            for (var c = 0; c < DAComplexity[engine].length; c++) {
                let record = DAComplexity[engine][c];
                if (size > record.size.min && size <= record.size.max) {
                    return record[complexity];
                }
            }
        }

        function updateTotal(add) {
            totalCost += add;
            $('#TotalCost').html(totalCost.toFixed(3) + ' Cloud Credits');
        }

        function deleteRow(rowId, cost) {
            updateTotal(cost * -1);
            $('#' + rowId).remove();
        }

        function showHelp(id) {
            var title = $('#infoTitle');
            var body = $('#infoBody');
            switch (id) {
                case 'PDF':
                    title.html('About Viewer PDF support');
                    body.html('PDF can be visualized using the Autodesk.PDF extension without translation, but requires the file to be hosted and served directly. <a href="https://forge.autodesk.com/en/docs/viewer/v7/reference/Extensions/PDFExtension/" target="_blank">Learn more</a>.')
                    break;
                case 'MDSource':
                    title.html('Where is the file?');
                    body.html('Autodesk products, like BIM 360 Document Manager (Docs), automatically prepare files for viewing. <br/><br/>If the file is stored somewhere else, like OneDrive or Dropbox, it needs to be transfered to Forge OSS and then prepared for viewing.');
                    break;
                case 'MDType':
                    title.html('Supported file formats');
                    body.html('Please refer to a complete <a href="https://forge.autodesk.com/en/docs/model-derivative/v2/developers_guide/supported-translations/" target="_blank">list of support formats</a>.')
                    break;
                case 'MDFrequency':
                    title.html('How often is the model updated?');
                    body.html('Each time the model is updated it needs to be prepared for viewing, in order to reflect the changes.');
                    break;
                case 'DASize':
                    title.html('File size');
                    body.html('The file size helps estimate the execution time based on thousands of other jobs. Larger files usually takes longer to open and execute automations. Use a values as close as possible.');
                    break;
                case 'DAComplexity':
                    title.html('Code complexity');
                    body.html('Based on thousands of other Design Automation executions, the suggested complexities are the following observed values: <ul><li><strong>Super simple</strong>: mininum.</li><li><strong>Simple</strong>: median (50% of all excutions).</li><li><strong>Average</strong>: average time.</li><li><strong>Complext</strong>: percentile 95 (95% of all executions).</li><li><strong>Super complex</strong>: maximum.</li></ul>');
                    break;
                case 'DAFrequency':
                    title.html('How often is this automation executed?');
                    body.html('Consider how many models needs to be executed against this automation. <br/><br/>For instace: your automation checks every new Revit version uploaded, and your team updates models 15 days per day (x 30 days equals 450 executions per month).');
                    break;
                case 'Disclaimer':
                    title.html('Disclaimer');
                    body.html('This Forge Cloud Credits Estimator is for informational and estimation purposes only and should not be relied upon when making a purchasing decision. Total amounts shown in the Estimator are based on various inputs and factors, including the then-current price list, only some of which are stated in the Estimator. As a result the amounts actually charged when any given customer purchases Forge Cloud Credits may differ materially from the total amounts estimated in the Forge Cloud Credits Estimator.<br/><br/>TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, THE OFFERINGS ARE PROVIDED “AS IS,” AND AUTODESK MAKES, AND YOU RECEIVE, NO WARRANTIES, REPRESENTATIONS, CONDITIONS OR COMMITMENTS OF ANY KIND, EXPRESS OR IMPLIED, WITH RESPECT TO THE ESTIMATOR OR ANY OUTPUT THEREOF, INCLUDING ANY IMPLIED WARRANTIES OF MERCHANTABILITY, SATISFACTORY QUALITY, FITNESS FOR A PARTICULAR PURPOSE OR NON‑INFRINGEMENT OR OTHER WARRANTIES OR CONDITIONS IMPLIED BY STATUTE, OR ANY WARRANTIES OR CONDITIONS BASED ON A COURSE OF DEALING, USAGE OF TRADE OR INDUSTRY STANDARDS.<br/><br/>WITHOUT LIMITATION AS TO THE GENERALITY OF THE FOREGOING, AUTODESK DOES NOT WARRANT OR OTHERWISE COMMIT THAT:<br/>- THE ESTIMATOR OR ANY OUTPUT THEREOF, OR THE ACCESS THERETO OR USE THEREOF, WILL BE AVAILABLE, UNINTERUPTED, ERROR-FREE, SECURE, ACCURATE, RELIABLE OR COMPLETE;<br/>- THE ESTIMATOR WILL MEET ANY PARTICULAR PERFORMANCE OR AVAILABILITY CRITERIA;OR<br/>- ERRORS WILL BE CORRECTED OR ANY PARTICULAR SUPPORT REQUESTS WILL BE RESOLVED TO MEET YOUR NEEDS. ');
                    break;
                case 'More':
                    title.html('Learn more');
                    body.html('Additional learning material: <br/><br/><a href="https://forge.autodesk.com/blog/forge-pricing-explained-1-how-access-forge" target="_blank">How to Access Forge</a><br/><a href="https://forge.autodesk.com/blog/forge-pricing-explained-2-forge-and-cloud-credits" target="_blank">Cloud Credits explained</a><br/><a href="https://forge.autodesk.com/blog/forge-pricing-explained-3-what-does-each-forge-api-cost" target="_blank">What does each Forge API cost?</a><br/><a href="https://forge.autodesk.com/blog/estimate-design-automation-costs" target="_blank">Design Automation cost</a>');
                    break;
                default:
                    break;
            }

            var myModal = new bootstrap.Modal(document.getElementById('infoModal'), {
                keyboard: false
            })
            myModal.toggle();
        }
    </script>
    <div class="container-sm">
        <div class="row">
            <div class="col" style="margin: 50px;">
                <center><a href="http://developer.autodesk.com" target="_blank">
                        <img alt="Autodesk Forge" src="//developer.static.autodesk.com/images/logo_forge-2-line.png"
                            height="60"></a>
                    <br /><br />
                    <h3>Cloud Credit Estimation</h3>
                </center>
            </div>
        </div>
        <div class="row">
            <div class="col-10">
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOne">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                I need to view 2D or 3D models or extract metadata
                            </button>
                        </h2>
                        <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne"
                            data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                Please specify where the files are hosted, type, how many files and how often files
                                are updated (per month).
                                <hr>
                                <div class="row">
                                    <div class="col-3">
                                        <label for="exampleDataList" class="form-label">Source <i
                                                class="fas fa-info-circle" style="cursor:help"
                                                onclick="showHelp('MDSource')"></i></label>
                                        <select class="form-select" aria-label="Default select example" id="MDSource">
                                            <option value="BIM360">BIM360 Docs</option>
                                            <option value="OneDrive">OneDrive</option>
                                            <option value="Dropbox">Dropbox</option>
                                            <option value="Local">Local drive</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div class="col-2">
                                        <label for="exampleDataList" class="form-label">File type <i
                                                class="fas fa-info-circle" style="cursor:help"
                                                onclick="showHelp('MDType')"></i></label>
                                        <select class="form-select" aria-label="Default select example"
                                            id="MDFileFormat">
                                            <option value="RVT">Revit</option>
                                            <option value="NWD/NWC">Navisworks</option>
                                            <option value="DWG/DXF">AutoCAD</option>
                                            <option value="IAM/IPT">Inventor</option>
                                            <option value="SLDASM/SLDPRT">Solidworks</option>
                                            <option value="DWF/DWFX">DWF/DWFx</option>
                                            <option value="PDF">PDF</option>
                                            <option value="STEP/OBJ">STEP/OBJ</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div class="col-3">
                                        <div class="mb-3">
                                            <label for="exampleFormControlInput1" class="form-label">How many
                                                models</label>
                                            <input type="number" class="form-control" id="MDCount" min="1" value="1">
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <label for="exampleFormControlInput1" class="form-label">How often is
                                            updated <i class="fas fa-info-circle" style="cursor:help"
                                                onclick="showHelp('MDFrequency')"></i></label>
                                        <div class="input-group mb-3">
                                            <input type="number" class="form-control" id="MDFrequency" min="1" value="1"
                                                aria-describedby="basic-addon2">
                                            <span class="input-group-text" id="basic-addon2">per month</span>
                                        </div>
                                    </div>
                                    <div class="col-1" style="margin-top: 33px;"><button type="button" id="MDAdd"
                                            class="btn btn-primary">Add</button>
                                    </div>
                                </div>
                                <hr />
                                <table class="table" id="MDTable">
                                    <thead>
                                        <tr>
                                            <th scope="col">Source</th>
                                            <th scope="col">Type</th>
                                            <th scope="col">Translations</th>
                                            <th scope="col">Cost</th>
                                            <th scope="col"></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                I need to create or modify files
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                            data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <div class="accordion-body">
                                    Please select the engine and how complex is the execution.
                                    <hr>
                                    <div class="row">
                                        <div class="col-2">
                                            <label for="exampleDataList" class="form-label">Engine </label>
                                            <select class="form-select" aria-label="Default select example"
                                                id="DAEngine">
                                                <option value="Revit">Revit</option>
                                                <!--<option value="AutoCAD">AutoCAD</option>
                                                <option value="Inventor">Inventor</option>
                                                <option value="Max">3ds Max</option>-->
                                            </select>
                                        </div>
                                        <div class="col-2">
                                            <label for="exampleFormControlInput1" class="form-label">File size <i
                                                    class="fas fa-info-circle" style="cursor:help"
                                                    onclick="showHelp('DASize')"></i></label>
                                            <div class="input-group mb-3">
                                                <input type="number" class="form-control" id="DASize" min="1" value="1"
                                                    aria-describedby="basic-addon2">
                                                <span class="input-group-text" id="basic-addon2">MBs</span>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <label for="DATimeComplexity" class="form-label">How complex is the
                                                code? <i class="fas fa-info-circle" style="cursor:help"
                                                    onclick="showHelp('DAComplexity')"></i></label>
                                            <select class="form-select" aria-label="Default select example"
                                                id="DAComplexity">
                                                <option value="min">Super simple</option>
                                                <option value="median">Simple</option>
                                                <option value="avg">Average</option>
                                                <option value="perc95">Complex</option>
                                                <option value="max">Super complex</option>
                                            </select>
                                        </div>
                                        <div class="col-3">
                                            <label for="exampleFormControlInput1" class="form-label">How often is
                                                executed <i class="fas fa-info-circle" style="cursor:help"
                                                    onclick="showHelp('DAFrequency')"></i></label>
                                            <div class="input-group mb-3">
                                                <input type="number" class="form-control" id="DAFrequency" min="1"
                                                    value="1" aria-describedby="basic-addon2">
                                                <span class="input-group-text" id="basic-addon2">per month</span>
                                            </div>
                                        </div>
                                        <div class="col-1" style="margin-top: 33px;"><button type="button" id="DAAdd"
                                                class="btn btn-primary">Add</button>
                                        </div>
                                    </div>
                                    <hr />
                                    <table class="table" id="DATable">
                                        <thead>
                                            <tr>
                                                <th scope="col">Engine</th>
                                                <th scope="col">Unit cost</th>
                                                <th scope="col">Frequency</th>
                                                <th scope="col">Cost</th>
                                                <th scope="col"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingThree">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                I need to generate mesh from photos/pictures
                            </button>
                        </h2>
                        <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree"
                            data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-2">
                <center>
                    <h4>Total per month<br /><span class="badge bg-secondary" id="TotalCost">00 Cloud Credits</span>
                        </h1> <br /></br> <span onclick="showHelp('Disclaimer')" style="cursor:pointer;"><a
                                href="#">Disclaimer</a></span><br /> <span><a href="https://forge.autodesk.com/pricing"
                                target="_blank">Pricing</a><br /></span> <span onclick="showHelp('More')"
                            style="cursor:pointer;"><a href="#">Learn more</a></span>
                </center>
            </div>
        </div>
    </div>
    <div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="infoTitle"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="infoBody">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Ok, thanks.</button>
                </div>
            </div>
        </div>
    </div>
</body>

</html>